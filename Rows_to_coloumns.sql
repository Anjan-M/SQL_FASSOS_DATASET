
--ROWS TO COLOUMNS VICECERSA
CREATE TABLE CONVERSION (
EMP_ID INT,
SALARY_COMPONENT_TYPE VARCHAR(10),
VAL INT
);

-- insert data into table 
INSERT INTO CONVERSION VALUES(1,'salary',10000);
INSERT INTO CONVERSION VALUES(1,'bonus',5000);
INSERT INTO CONVERSION VALUES(1,'hike',7);
INSERT INTO CONVERSION VALUES(2,'salary',15000);
INSERT INTO CONVERSION VALUES(2,'bonus',7000);
INSERT INTO CONVERSION VALUES(2,'hike',8);
INSERT INTO CONVERSION VALUES(3,'salary',12000);
INSERT INTO CONVERSION VALUES(3,'bonus',6000);
INSERT INTO CONVERSION VALUES(3,'hike',7);

drop table CONVERSION
 select * from Conversion;


SELECT 
 EMP_ID
 ,SUM(CASE WHEN SALARY_COMPONENT_TYPE = 'SALARY' THEN VAL END) AS SALARY
 ,SUM(CASE WHEN SALARY_COMPONENT_TYPE = 'BONUS' THEN VAL END) AS BONUS
 ,SUM(CASE WHEN SALARY_COMPONENT_TYPE = 'HIKE' THEN VAL END) AS HIKE

 INTO CONVERSION_PIVOT
 FROM CONVERSION
 GROUP BY EMP_ID;


 SELECT * FROM(
 SELECT EMP_ID, 'SALARY' AS SALARY_COMPONENT_TYPE, SALARY AS VAL FROM CONVERSION_PIVOT
 UNION ALL
 SELECT EMP_ID, 'BONUS' AS SALARY_COMPONENT_TYPE, BONUS AS VAL FROM CONVERSION_PIVOT
 UNION ALL
 SELECT EMP_ID, 'HIKE' AS SALARY_COMPONENT_TYPE, HIKE AS VAL FROM CONVERSION_PIVOT
 )A
 ORDER BY EMP_ID